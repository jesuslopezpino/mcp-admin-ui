<div class="terminal-container">
  <div class="terminal-header">
    <div class="terminal-info-row">
      <div class="target-info" *ngIf="targetHostname || targetIp">
        <span class="info-label">ğŸ¯ Destino:</span>
        <span class="info-value">{{ getTargetDisplayName() }}</span>
      </div>
      <div class="command-info" *ngIf="commandName">
        <span class="info-label">ğŸ”§ Comando:</span>
        <span class="info-value">{{ getCommandDisplayName() }}</span>
      </div>
      <div class="terminal-status" [style.color]="getStatusColor()">
        <span class="status-icon">{{ getStatusIcon() }}</span>
        {{ status }} (Exit Code: {{ exitCode }})
      </div>
    </div>
  </div>
  
  <div class="terminal-body" data-testid="run-modal-stdout">
    <pre class="terminal-output">{{ getDisplayOutput() }}</pre>
    <div class="truncate-notice" *ngIf="isTruncated && !showFullOutput">
      <button class="btn-expand" (click)="toggleOutput()" data-testid="terminal-expand">
        ğŸ‘ï¸ Ver todo ({{formattedOutput.length}} caracteres)
      </button>
    </div>
    <div class="truncate-notice" *ngIf="isTruncated && showFullOutput">
      <button class="btn-collapse" (click)="toggleOutput()">
        ğŸ”¼ Ocultar
      </button>
    </div>
  </div>
  
  <div class="terminal-footer">
    <div class="terminal-actions">
      <button class="btn-copy" (click)="copyToClipboard()" title="Copiar al portapapeles" data-testid="terminal-output-copy">
        ğŸ“‹ Copiar
      </button>
      <button class="btn-download" (click)="downloadOutput()" title="Descargar como archivo" data-testid="terminal-output-download">
        ğŸ’¾ Descargar
      </button>
      <button class="btn-fullscreen" (click)="toggleFullscreen()" title="Ver en pantalla completa">
        ğŸ” Pantalla completa
      </button>
    </div>
  </div>
</div>

<!-- Fullscreen Modal -->
<div class="fullscreen-overlay" *ngIf="isFullscreen" (click)="closeFullscreen()">
  <div class="fullscreen-terminal" (click)="$event.stopPropagation()">
    <div class="fullscreen-header">
      <div class="fullscreen-info-row">
        <div class="target-info" *ngIf="targetHostname || targetIp">
          <span class="info-label">ğŸ¯ Destino:</span>
          <span class="info-value">{{ getTargetDisplayName() }}</span>
        </div>
        <div class="command-info" *ngIf="commandName">
          <span class="info-label">ğŸ”§ Comando:</span>
          <span class="info-value">{{ getCommandDisplayName() }}</span>
        </div>
        <div class="terminal-status" [style.color]="getStatusColor()">
          <span class="status-icon">{{ getStatusIcon() }}</span>
          {{ status }} (Exit Code: {{ exitCode }})
        </div>
      </div>
      <button class="btn-close-fullscreen" (click)="closeFullscreen()" title="Close fullscreen">
        âœ•
      </button>
    </div>
    
    <div class="fullscreen-body">
      <pre class="terminal-output fullscreen">{{ formattedOutput }}</pre>
    </div>
    
    <div class="fullscreen-footer">
      <div class="fullscreen-actions">
        <button class="btn-copy" (click)="copyToClipboard()" title="Copy to clipboard">
          ğŸ“‹ Copy
        </button>
        <button class="btn-download" (click)="downloadOutput()" title="Download output">
          ğŸ’¾ Download
        </button>
        <button class="btn-close-fullscreen" (click)="closeFullscreen()" title="Close fullscreen">
          âœ• Close
        </button>
      </div>
    </div>
  </div>
</div>
