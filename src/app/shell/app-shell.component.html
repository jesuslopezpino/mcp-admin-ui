<div class="app-shell" data-testid="app-shell">
  <!-- Topbar -->
  <p-toolbar class="topbar">
    <ng-template pTemplate="left">
      <button 
        pButton 
        type="button" 
        icon="pi pi-bars" 
        class="p-button-text p-button-sm md:hidden"
        (click)="toggleSidebar()"
        data-testid="sidebar-toggle">
      </button>
      <div class="flex align-items-center gap-3 ml-3">
        <i class="pi pi-cog text-primary text-2xl"></i>
        <h1 class="app-title m-0">MCP Admin Panel</h1>
      </div>
    </ng-template>
    
    <ng-template pTemplate="right">
      <div class="flex align-items-center gap-2">
        <p-button 
          [icon]="isDarkTheme ? 'pi pi-sun' : 'pi pi-moon'" 
          class="p-button-text p-button-sm"
          (click)="toggleTheme()"
          [pTooltip]="isDarkTheme ? 'Switch to Light Theme' : 'Switch to Dark Theme'"
          data-testid="theme-toggle">
        </p-button>
        
        <p-menu [model]="topbarItems" [popup]="true" #userMenu></p-menu>
        <p-button 
          icon="pi pi-user" 
          class="p-button-text p-button-sm"
          (click)="userMenu.toggle($event)"
          [pTooltip]="'User Menu'"
          data-testid="user-menu">
        </p-button>
      </div>
    </ng-template>
  </p-toolbar>

  <!-- Main Layout -->
  <div class="main-layout">
    <!-- Sidebar -->
    <div class="sidebar hidden md:block">
      <p-panelMenu [model]="menuItems" styleClass="w-full border-none"></p-panelMenu>
    </div>
    
    <!-- Mobile Drawer -->
    <p-drawer 
      [(visible)]="sidebarVisible" 
      position="left" 
      styleClass="p-drawer-custom md:hidden"
      data-testid="sidebar">
      <div class="sidebar-content">
        <p-panelMenu [model]="menuItems" styleClass="w-full border-none"></p-panelMenu>
      </div>
    </p-drawer>

    <!-- Main Content -->
    <div class="main-content">
      <div class="content-wrapper">
        <router-outlet></router-outlet>
      </div>
    </div>
  </div>

  <!-- Global Components -->
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>
</div>
